<html>
  <head>
	<link href='http://fonts.googleapis.com/css?family=Cabin+Sketch:bold&v1' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Play&v1' rel='stylesheet' type='text/css'>
    
	<link type="text/css" href="css/redmond/jquery-ui-1.8.13.custom.css" rel="Stylesheet">	
	<link type="text/css" href="css/client.css" rel="Stylesheet">	
	<script> var ws = null; </script>

	<script type="text/javascript" src="js/jquery-1.5.1.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui-1.8.13.custom.min.js"></script>
	<script type="text/javascript" src="js/liscroll.1.0.js"></script>
	<script type="text/javascript" src="js/client.js"></script>
	<script>
	  $(function(){
	    ws = new WebSocket("<%= 'ws://'+host+':8080' %>");
	    ws.onmessage = function(e) { 
	        var received = JSON.parse(e.data);
	        if(received["form"]) {
	          var data = received["form"];
	          eval("var passed_buttons =" + data[1]["buttons"]); 
	          $("#"+scroll(data[0])).dialog({
	            show: data[1]["show"],
	            hide: data[1]["hide"],
	            title: data[1]["title"],
	            width: "auto",
      	        resizable: false,
          		modal: true,
          		buttons: passed_buttons
          	  });
	        }
	        if(received["cmd"]) {
	          if(received["cmd"] == "clear_screen") {
	              $("#scrolling-region").empty();
	              console.log("Screen cleared.");
	          }
	        }
	        if(received["scrollback"]) {
  	          $("button, input:submit, a", "#"+scroll(received["scrollback"])).button();
  	        } 
  	        if(received["dialog"]) {
  	          $("#"+scroll(received["dialog"])).dialog({
  	            resizable: false,
      			modal: true,
      			buttons: {
    				Ok: function() {
    					$( this ).dialog( "close" );
    				}
    			},
    			show: "highlight",
    			hide: "explode"
      		  });
  	        }
	    };
	    ws.onclose = function() { debug("<span style=\"color:red;\">Socket closed.</span>"); };
	    ws.onopen = function() { debug("Connected."); };
  	  });
	</script>
  </head>
  <body>
	<div id="client-region">
      <div id="debug"></div>
      <div id="scrolling-region"></div>
	</div>
  </body>
</html>